<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serenity</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="container">
            <div class="logo">
                <h1>SERE<span class="highlight">NITY</span></h1>
            </div>
            <nav>
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="#about-image">About Us</a></li>
                    {% if isLogged %}
                        <li><a onclick="logOut()" class="sign-in-btn">Log-Out</a></li>
                    {% else %}
                        <li><a href="#full-width-image" class="sign-in-btn">Log-In</a></li>    
                    {% endif %}
                </ul>
            </nav>
        </div>
    </header>

    <!-- Background Images -->
    <div class="bg-left"></div>
    <div class="bg-right"></div>

    <!-- Main Section -->
    <main>
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 col-md-6 col-sm-12">
                    <div class="content">
                        <h2>Welcome to Serenity <span class="gemini">{{ userName }}</span></h2>
                        <h1>Empowering Students to Thrive</h1>
                        <p>Our advanced AI system evaluates your mental well-being and offers actionable remedies to reduce stress.</p>
                        <a href="#" class="btn-analyze mt-3" onclick="redirectToChatbot()">Analyze Stress</a>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-12">
                    <div class="image-container">
                        <img src="{{ url_for('static', filename='main-chat-icon.png') }}" alt="Chat Icon" class="img-fluid">
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- About Image Section -->
    <section id="about-image" class="about-image">
        <div id="about" class="about-us section">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4 col-md-4 col-sm-12">
                        <div class="box item wow fadeIn" data-wow-duration="1s" data-wow-delay="0.5s">
                            <div class="right-text">
                                <h5><b>Measuring Impact</b></h5>
                                <p>Our in-depth evaluations showcase the chatbot's effectiveness in reducing stress and enhancing users' mental wellness.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-12">
                        <div class="box item wow fadeIn" data-wow-duration="1s" data-wow-delay="1.1s">
                            <div class="right-text">
                                <h5><b>Evidence-Based Analysis</b></h5>
                                <p>With a comprehensive knowledge base, we offer proven stress management techniques tailored to each user's needs.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-12">
                        <div class="box item wow fadeIn" data-wow-duration="1s" data-wow-delay="1.5s">
                            <div class="right-text">
                                <h5><b>Personalized Mental Health Insights</b></h5>
                                <p>We evaluate user's mental health and offer personalized recommendations, improving overall mental health and well-being.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Full-Width Image Section with Sign-In Overlay -->
    {% if not isLogged %} 
    <section id="full-width-image" class="full-width-image">
        <img src="{{ url_for('static', filename='image.png') }}" alt="Full Width Banner">
    {% endif %}
    
    <!-- Sign-In Form Overlay -->
    {% if not isLogged %}
    <div class="sign-in-overlay">
        {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        <ul class="flashes">
                            {% for category, message in messages %}
                                <li class="{{ category }}">{{ message }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
        {% endwith %}
        <div class="toggle-buttons text-center mb-3">
            <button class="btn btn-secondary" onclick="showLogin()">Log-In</button>
            <button class="btn btn-secondary" onclick="showCreateAccount()">Create New Account</button>
        </div>
        <!-- Login Form -->
        <form id="login-form" action="/login" method="post" class="sign-in-form">
            <div class="form-group">
                <label for="login-email">Email:</label>
                <input type="email" class="form-control" name="email" id="login-email" placeholder="Enter your email" required>
            </div>
            <div class="form-group">
                <label for="login-password">Password:</label>
                <input type="password" class="form-control" name="password" id="login-password" placeholder="Enter your password" required>
            </div>
            <button type="submit" class="btn btn-primary">Log-In</button>
        </form>

        <!-- Create Account Form -->
        <form id="create-account-form" action="/create-account" method="post" class="sign-in-form d-none">
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" class="form-control" name="name" id="name" placeholder="Enter your name" required>
            </div>
            <div class="form-group">
                <label for="create-email">Email:</label>
                <input type="email" class="form-control" name="email" id="create-email" placeholder="Enter your email" required>
            </div>
            <div class="form-group">
                <label for="create-password">Password:</label>
                <input type="password" class="form-control" name="password" id="create-password" placeholder="Enter your password" required>
            </div>
            <button type="submit" class="btn btn-success">Create Account</button>
        </form>
    </div>
    {% endif %}
    </section>

    <script>
        const isLogged="{{isLogged}}";

        function redirectToChatbot() {
            if (isLogged == "True") {
                window.location.href = '/chat-bot.html';
            } else {
                alert("You need to log-in to analyze your stress.");
                window.location.href = '#full-width-image';  // Redirect to the sign-in section
            }
        }

        function logOut() {
            fetch('/log-out', {
                method: 'POST',
                credentials: 'same-origin',
            })
            .then(response => {
                if (response.redirected) {
                    window.location.href = response.url;
                }
            })
            .catch(error => {
                console.error('Error logging out:', error);
            });
        }

        // Show the login form and hide the create account form
        function showLogin() {
            document.getElementById('login-form').classList.remove('d-none');
            document.getElementById('create-account-form').classList.add('d-none');
        }

        // Show the create account form and hide the login form
        function showCreateAccount() {
            document.getElementById('create-account-form').classList.remove('d-none');
            document.getElementById('login-form').classList.add('d-none');
        }

        // Form validation
        document.getElementById('login-form').onsubmit = function() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            if (!email || !password) {
                alert('Please fill in all fields.');
                return false; // Prevent form submission
            }
            return true; // Allow form submission
        };

        document.getElementById('create-account-form').onsubmit = function() {
            const name = document.getElementById('name').value;
            const email = document.getElementById('create-email').value;
            const password = document.getElementById('create-password').value;
            if (!name || !email || !password) {
                alert('Please fill in all fields.');
                return false; // Prevent form submission
            }
            return true; // Allow form submission
        };
    </script>
</body>
</html>
